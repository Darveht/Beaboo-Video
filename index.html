
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="format-detection" content="telephone=no">
  <title>Video App Estilo Twitter</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    /* Reinicio b谩sico */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background-color: #000000;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      overscroll-behavior: contain;
      color: #ffffff;
      position: relative;
      padding-bottom: 80px;
    }

    /* Header estilo Twitter */
    .header {
      width: 100%;
      padding: 12px 16px;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(12px);
      border-bottom: 0.5px solid #333639;
      position: sticky;
      top: 0;
      z-index: 900;
    }
    
    .search-container {
      position: relative;
      max-width: 500px;
      margin: 0 auto;
    }
    
    .search-wrapper {
      position: relative;
      display: flex;
      align-items: center;
      background: #202327;
      border-radius: 50px;
      border: 1px solid #333639;
      transition: all 0.2s ease;
    }
    
    .search-wrapper:focus-within {
      background: #000000;
      border-color: #1d9bf0;
      box-shadow: 0 0 0 1px #1d9bf0;
    }
    
    .search-icon {
      padding: 0 16px;
      color: #71767b;
      font-size: 18px;
    }
    
    .search-wrapper:focus-within .search-icon {
      color: #1d9bf0;
    }
    
    .header input {
      flex: 1;
      padding: 12px 0;
      border: none;
      background: transparent;
      color: #ffffff;
      font-size: 15px;
      outline: none;
      border-radius: 50px;
    }
    
    .header input::placeholder {
      color: #71767b;
    }
    
    .search-btn {
      background: transparent;
      border: none;
      color: #71767b;
      padding: 8px 16px;
      cursor: pointer;
      border-radius: 50px;
      transition: all 0.2s ease;
    }
    
    .search-btn:hover {
      background: rgba(29, 155, 240, 0.1);
      color: #1d9bf0;
    }
    
    .spinner {
      margin-left: 8px;
      color: #1d9bf0;
    }
    
    .hidden {
      display: none;
    }

    /* Contenedor principal estilo Twitter */
    .app-container {
      height: calc(100vh - 80px);
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      background: #000000;
    }
    
    .video-container {
      position: relative;
      width: 100%;
      max-width: 420px;
      height: 100%;
      overflow: hidden;
      border-radius: 0;
    }
    
    .upload-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      z-index: 10;
      background: rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(12px);
      border-radius: 50%;
      padding: 12px;
      cursor: pointer;
      color: #ffffff;
      border: 1px solid #333639;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }
    
    .upload-btn:hover {
      background: rgba(29, 155, 240, 0.1);
      border-color: #1d9bf0;
      color: #1d9bf0;
      transform: scale(1.05);
    }
    
    .video-wrapper {
      width: 100%;
      height: 100%;
      position: relative;
    }
    
    video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      pointer-events: none;
    }
    
    /* Ocultar todos los controles nativos de video en iOS/Safari */
    video::-webkit-media-controls {
      display: none !important;
      -webkit-appearance: none !important;
    }
    
    video::-webkit-media-controls-enclosure {
      display: none !important;
    }
    
    video::-webkit-media-controls-panel {
      display: none !important;
    }
    
    video::-webkit-media-controls-play-button {
      display: none !important;
    }
    
    video::-webkit-media-controls-start-playback-button {
      display: none !important;
    }
    
    video::-webkit-media-controls-timeline-container {
      display: none !important;
    }
    
    video::-webkit-media-controls-current-time-display {
      display: none !important;
    }
    
    video::-webkit-media-controls-time-remaining-display {
      display: none !important;
    }
    
    video::-webkit-media-controls-timeline {
      display: none !important;
    }
    
    video::-webkit-media-controls-volume-slider-container {
      display: none !important;
    }
    
    video::-webkit-media-controls-volume-slider {
      display: none !important;
    }
    
    video::-webkit-media-controls-mute-button {
      display: none !important;
    }
    
    video::-webkit-media-controls-fullscreen-button {
      display: none !important;
    }
    
    video::-webkit-media-controls-rewind-button {
      display: none !important;
    }
    
    video::-webkit-media-controls-return-to-realtime-button {
      display: none !important;
    }
    
    video::-webkit-media-controls-toggle-closed-captions-button {
      display: none !important;
    }
    
    /* Prevenir selecci贸n y arrastre del video */
    video {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-user-drag: none;
      -khtml-user-drag: none;
      -moz-user-drag: none;
      -o-user-drag: none;
      user-drag: none;
      -webkit-touch-callout: none;
    }
    
    .video-controls {
      position: absolute;
      right: 16px;
      bottom: 80px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      transition: transform 0.3s ease;
    }
    
    .video-controls.hidden {
      transform: translateX(100px);
    }
    
    .like-btn, .fav-btn {
      background: rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(12px);
      border: 1px solid #333639;
      color: #ffffff;
      cursor: pointer;
      padding: 12px;
      font-size: 20px;
      border-radius: 50%;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .like-btn.active {
      background: rgba(249, 24, 128, 0.2);
      border-color: #f91880;
      color: #f91880;
      animation: likeAnimation 0.5s ease;
    }
    
    .fav-btn.active {
      background: rgba(255, 212, 0, 0.2);
      border-color: #ffd400;
      color: #ffd400;
    }
    
    @keyframes likeAnimation {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
    
    .progress-container {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background-color: rgba(113, 118, 123, 0.3);
    }
    
    .progress-bar {
      height: 100%;
      background-color: #1d9bf0;
      width: 0%;
      transition: width 0.1s linear;
    }
    
    .video-indicators {
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    
    .indicator {
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background-color: rgba(113, 118, 123, 0.6);
      transition: all 0.3s ease;
    }
    
    .indicator.active {
      background-color: #1d9bf0;
      height: 16px;
      border-radius: 2px;
    }
    
    .empty-state {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #71767b;
      text-align: center;
      padding: 24px;
    }
    
    .empty-state i {
      font-size: 64px;
      margin-bottom: 16px;
      color: #333639;
    }
    
    .empty-state p {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    
    .empty-state span {
      font-size: 15px;
      color: #71767b;
    }
    
    #fileInput {
      display: none;
    }
    
    .pause-indicator {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      color: #ffffff;
      font-size: 64px;
      opacity: 0;
      transition: all 0.3s ease;
      background: rgba(0, 0, 0, 0.75);
      backdrop-filter: blur(12px);
      border-radius: 50%;
      width: 96px;
      height: 96px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .pause-indicator.visible {
      transform: translate(-50%, -50%) scale(1);
      opacity: 1;
    }

    /* Secci贸n de Perfil estilo Twitter */
    .profile-section {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: #000000;
      color: #ffffff;
      padding: 0;
      z-index: 2000;
    }
    
    .profile-section.hidden {
      display: none;
    }
    
    .profile-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px;
      border-bottom: 0.5px solid #333639;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(12px);
    }
    
    .profile-header h2 {
      font-size: 20px;
      font-weight: 800;
    }
    
    .profile-header button {
      background: transparent;
      border: 1px solid #333639;
      color: #ffffff;
      padding: 8px 16px;
      border-radius: 50px;
      cursor: pointer;
      font-weight: 700;
      transition: all 0.2s ease;
    }
    
    .profile-header button:hover {
      background: rgba(231, 233, 234, 0.1);
    }
    
    .profile-content {
      padding: 24px 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .profile-photo {
      position: relative;
      margin-bottom: 24px;
    }
    
    .profile-photo img {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid #1d9bf0;
    }
    
    .profile-photo input {
      position: absolute;
      bottom: 0;
      right: 0;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }
    
    .profile-info {
      width: 100%;
      max-width: 400px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .profile-info input {
      padding: 16px;
      border-radius: 8px;
      border: 1px solid #333639;
      background: #202327;
      color: #ffffff;
      font-size: 17px;
    }
    
    .profile-info input:focus {
      outline: none;
      border-color: #1d9bf0;
      box-shadow: 0 0 0 1px #1d9bf0;
    }
    
    .profile-info button {
      background: #1d9bf0;
      border: none;
      color: #ffffff;
      padding: 12px 24px;
      border-radius: 50px;
      cursor: pointer;
      font-weight: 700;
      font-size: 15px;
      transition: all 0.2s ease;
    }
    
    .profile-info button:hover {
      background: #1a8cd8;
    }

    /* Reproductor personalizado para paisaje */
    .landscape-player {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #000000;
      z-index: 3000;
      display: none;
    }
    
    .landscape-player.active {
      display: flex;
    }
    
    .landscape-video-container {
      width: 100%;
      height: 100%;
      position: relative;
    }
    
    .landscape-video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      pointer-events: none;
    }
    
    /* Ocultar controles nativos en el reproductor paisaje */
    .landscape-video::-webkit-media-controls,
    .landscape-video::-webkit-media-controls-enclosure,
    .landscape-video::-webkit-media-controls-panel,
    .landscape-video::-webkit-media-controls-play-button,
    .landscape-video::-webkit-media-controls-start-playback-button,
    .landscape-video::-webkit-media-controls-timeline-container,
    .landscape-video::-webkit-media-controls-current-time-display,
    .landscape-video::-webkit-media-controls-time-remaining-display,
    .landscape-video::-webkit-media-controls-timeline,
    .landscape-video::-webkit-media-controls-volume-slider-container,
    .landscape-video::-webkit-media-controls-volume-slider,
    .landscape-video::-webkit-media-controls-mute-button,
    .landscape-video::-webkit-media-controls-fullscreen-button,
    .landscape-video::-webkit-media-controls-rewind-button,
    .landscape-video::-webkit-media-controls-return-to-realtime-button,
    .landscape-video::-webkit-media-controls-toggle-closed-captions-button {
      display: none !important;
      -webkit-appearance: none !important;
    }
    
    .landscape-video {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      -webkit-user-drag: none;
      -khtml-user-drag: none;
      -moz-user-drag: none;
      -o-user-drag: none;
      user-drag: none;
      -webkit-touch-callout: none;
    }
    
    .landscape-controls {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(transparent, rgba(0,0,0,0.8));
      padding: 16px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .landscape-controls button {
      background: rgba(255,255,255,0.2);
      border: none;
      color: #ffffff;
      padding: 12px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 18px;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }
    
    .landscape-controls button:hover {
      background: rgba(29, 155, 240, 0.3);
    }
    
    .landscape-progress {
      flex: 1;
      height: 4px;
      background: rgba(113, 118, 123, 0.3);
      border-radius: 2px;
      overflow: hidden;
    }
    
    .landscape-progress-fill {
      height: 100%;
      background: #1d9bf0;
      width: 0%;
      transition: width 0.1s linear;
    }
    
    /* Subt铆tulos modernos */
    .subtitle-container {
      position: absolute;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      max-width: 80%;
      text-align: center;
      z-index: 10;
    }
    
    .subtitle-text {
      background: rgba(0, 0, 0, 0.85);
      color: #ffffff;
      padding: 12px 20px;
      border-radius: 12px;
      font-size: 16px;
      line-height: 1.4;
      backdrop-filter: blur(12px);
      border: 1px solid #333639;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Panel de configuraci贸n de subt铆tulos */
    .subtitle-settings {
      position: absolute;
      top: 16px;
      right: 16px;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 16px;
      border: 1px solid #333639;
      padding: 24px;
      color: #ffffff;
      display: none;
      min-width: 320px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
      animation: slideIn 0.3s ease;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .subtitle-settings.visible {
      display: block;
    }
    
    .subtitle-settings h3 {
      margin-bottom: 20px;
      font-size: 20px;
      font-weight: 800;
      color: #ffffff;
      text-align: center;
    }
    
    .subtitle-settings select {
      width: 100%;
      padding: 16px;
      margin: 12px 0;
      border-radius: 12px;
      border: 1px solid #333639;
      background: #202327;
      color: #ffffff;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .subtitle-settings select:focus {
      outline: none;
      border-color: #1d9bf0;
      box-shadow: 0 0 0 2px rgba(29, 155, 240, 0.2);
      background: #000000;
    }
    
    .subtitle-settings select option {
      background: #202327;
      color: #ffffff;
      padding: 12px;
    }
    
    .subtitle-settings button {
      width: 100%;
      padding: 16px;
      margin: 8px 0;
      border: none;
      border-radius: 50px;
      background: #1d9bf0;
      color: #ffffff;
      cursor: pointer;
      font-weight: 700;
      font-size: 16px;
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }
    
    .subtitle-settings button:hover {
      background: #1a8cd8;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(29, 155, 240, 0.3);
    }
    
    .subtitle-settings button:active {
      transform: translateY(0);
    }
    
    .subtitle-settings button.secondary {
      background: transparent;
      border: 1px solid #333639;
      color: #ffffff;
    }
    
    .subtitle-settings button.secondary:hover {
      background: rgba(231, 233, 234, 0.1);
      border-color: #71767b;
    }
    
    .subtitle-settings label {
      display: block;
      margin: 16px 0 8px 0;
      font-size: 15px;
      font-weight: 700;
      color: #ffffff;
    }
    
    .subtitle-status {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      background: rgba(29, 155, 240, 0.1);
      border-radius: 12px;
      margin: 12px 0;
      border: 1px solid rgba(29, 155, 240, 0.3);
    }
    
    .subtitle-status.active {
      background: rgba(0, 186, 124, 0.1);
      border-color: rgba(0, 186, 124, 0.3);
    }
    
    .subtitle-status span {
      font-size: 14px;
      font-weight: 600;
    }
    
    .subtitle-status .status-indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #71767b;
    }
    
    .subtitle-status.active .status-indicator {
      background: #00ba7c;
      animation: pulse 2s infinite;
    }
    
    /* Indicador de transcripci贸n activa */
    .transcription-indicator {
      position: absolute;
      top: 16px;
      left: 16px;
      background: rgba(29, 155, 240, 0.9);
      color: #ffffff;
      padding: 8px 16px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: 600;
      display: none;
      align-items: center;
      gap: 8px;
    }
    
    .transcription-indicator.active {
      display: flex;
    }
    
    .transcription-indicator .pulse {
      width: 8px;
      height: 8px;
      background: #ffffff;
      border-radius: 50%;
      animation: pulse 1s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    /* Barra de navegaci贸n inferior estilo Twitter */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(12px);
      border-top: 0.5px solid #333639;
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
      z-index: 1000;
    }
    
    .bottom-nav button {
      background: none;
      border: none;
      color: #71767b;
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      padding: 8px 16px;
      border-radius: 50px;
      transition: all 0.2s ease;
      min-width: 80px;
    }
    
    .bottom-nav button:hover,
    .bottom-nav button.active {
      color: #1d9bf0;
      background: rgba(29, 155, 240, 0.1);
    }
    
    .bottom-nav button i {
      font-size: 24px;
      margin-bottom: 4px;
    }
  </style>
</head>
<body>
  <!-- Header de b煤squeda estilo Twitter -->
  <header class="header">
    <div class="search-container">
      <div class="search-wrapper">
        <div class="search-icon">
          <i class="fas fa-search"></i>
        </div>
        <input type="text" id="searchInput" placeholder="Buscar videos">
        <button class="search-btn" id="searchBtn">
          <i class="fas fa-arrow-right"></i>
        </button>
        <div id="searchSpinner" class="spinner hidden">
          <i class="fas fa-spinner fa-spin"></i>
        </div>
      </div>
    </div>
  </header>

  <!-- Secci贸n de Inicio -->
  <div id="homeSection" class="app-container">
    <div class="video-container">
      <label class="upload-btn" for="fileInput">
        <i class="fas fa-plus"></i>
      </label>
      <input type="file" id="fileInput" multiple accept="video/*">
      
      <div id="videoWrapper" class="video-wrapper">
        <div class="empty-state">
          <i class="fas fa-video"></i>
          <p>隆Sube tu primer video!</p>
          <span>Comparte videos incre铆bles con el mundo</span>
        </div>
      </div>
      
      <div class="video-controls">
        <button class="like-btn" id="likeBtn">
          <i class="fas fa-heart"></i>
        </button>
        <button class="fav-btn" id="favBtn">
          <i class="fas fa-bookmark"></i>
        </button>
      </div>
      
      <div class="video-indicators" id="indicators"></div>
      
      <div class="pause-indicator">
        <i class="fas fa-pause"></i>
      </div>

      <div class="progress-container">
        <div class="progress-bar"></div>
      </div>
    </div>
  </div>

  <!-- Secci贸n de Perfil -->
  <div id="profileSection" class="profile-section hidden">
    <div class="profile-header">
      <h2>Perfil</h2>
      <button id="backToHome"><i class="fas fa-arrow-left"></i> Volver</button>
    </div>
    <div class="profile-content">
      <div class="profile-photo">
        <img id="profileImage" src="https://via.placeholder.com/120" alt="Foto de perfil">
        <input type="file" id="profilePhotoInput" accept="image/*">
      </div>
      <div class="profile-info">
        <input type="text" id="usernameInput" placeholder="Nombre de usuario">
        <button id="saveProfile">Guardar cambios</button>
      </div>
    </div>
  </div>

  <!-- Reproductor personalizado para paisaje -->
  <div id="landscapePlayer" class="landscape-player">
    <div class="landscape-video-container">
      <video id="landscapeVideo" class="landscape-video" controls></video>
      
      <!-- Indicador de transcripci贸n -->
      <div id="transcriptionIndicator" class="transcription-indicator">
        <div class="pulse"></div>
        <span>Transcribiendo...</span>
      </div>
      
      <!-- Configuraci贸n de subt铆tulos -->
      <div id="subtitleSettings" class="subtitle-settings">
        <h3><i class="fas fa-closed-captioning"></i> Subt铆tulos y Traducci贸n</h3>
        
        <div class="subtitle-status" id="subtitleStatus">
          <span>Estado: Inactivo</span>
          <div class="status-indicator"></div>
        </div>
        
        <label><i class="fas fa-microphone"></i> Idioma del Video:</label>
        <select id="sourceLanguage">
          <option value="es-ES"> Espa帽ol</option>
          <option value="en-US">吼 Ingl茅s</option>
          <option value="fr-FR"> Franc茅s</option>
          <option value="de-DE"> Alem谩n</option>
          <option value="it-IT"> Italiano</option>
          <option value="pt-BR">ю Portugu茅s</option>
          <option value="ja-JP"> Japon茅s</option>
          <option value="ko-KR">梆 Coreano</option>
          <option value="zh-CN"> Chino</option>
        </select>
        
        <label><i class="fas fa-language"></i> Traducir a:</label>
        <select id="targetLanguage">
          <option value="es"> Espa帽ol</option>
          <option value="en">吼 Ingl茅s</option>
          <option value="fr"> Franc茅s</option>
          <option value="de"> Alem谩n</option>
          <option value="it"> Italiano</option>
          <option value="pt">ю Portugu茅s</option>
          <option value="ja"> Japon茅s</option>
          <option value="ko">梆 Coreano</option>
          <option value="zh"> Chino</option>
          <option value="ar">葛 rabe</option>
          <option value="ru">佛 Ruso</option>
        </select>
        
        <button id="toggleSubtitles"><i class="fas fa-closed-captioning"></i> Activar Subt铆tulos</button>
        <button id="toggleTranslation"><i class="fas fa-language"></i> Activar Traducci贸n</button>
        <button id="closeSettings" class="secondary"><i class="fas fa-times"></i> Cerrar</button>
      </div>
      
      <!-- Contenedor de subt铆tulos -->
      <div id="subtitleContainer" class="subtitle-container">
        <div id="subtitleText" class="subtitle-text"></div>
      </div>
      
      <!-- Controles personalizados -->
      <div class="landscape-controls">
        <button id="landscapePlayPause"><i class="fas fa-play"></i></button>
        <button id="landscapeRewind"><i class="fas fa-backward"></i></button>
        <div class="landscape-progress">
          <div id="landscapeProgressFill" class="landscape-progress-fill"></div>
        </div>
        <button id="landscapeForward"><i class="fas fa-forward"></i></button>
        <button id="landscapeVolume"><i class="fas fa-volume-up"></i></button>
        <button id="landscapeSubtitles"><i class="fas fa-closed-captioning"></i></button>
        <button id="landscapeClose"><i class="fas fa-times"></i></button>
      </div>
    </div>
  </div>

  <!-- Barra de navegaci贸n inferior estilo Twitter -->
  <nav class="bottom-nav">
    <button id="navHome" class="active">
      <i class="fas fa-home"></i>
      <span>Inicio</span>
    </button>
    <button id="navProfile">
      <i class="fas fa-user"></i>
      <span>Perfil</span>
    </button>
  </nav>

  <script>
    /***************** Variables Globales ******************/
    let videos = [];
    let currentIndex = 0;
    let likes = {};
    let favorites = {};
    let touchStartY = 0;
    let touchStartX = 0;
    let lastTapTime = 0;
    let touchStartTime = 0;
    let progressInterval;
    
    // Variables para el reproductor personalizado
    let isLandscape = false;
    let recognition;
    let subtitlesEnabled = false;
    let translationEnabled = false;
    let currentSubtitle = '';
    let landscapeProgressInterval;

    /***************** Elementos del DOM ******************/
    const fileInput = document.getElementById('fileInput');
    const videoWrapper = document.getElementById('videoWrapper');
    const indicators = document.getElementById('indicators');
    const likeBtn = document.getElementById('likeBtn');
    const favBtn = document.getElementById('favBtn');
    const searchBtn = document.getElementById('searchBtn');
    const searchInput = document.getElementById('searchInput');
    const searchSpinner = document.getElementById('searchSpinner');
    const homeSection = document.getElementById('homeSection');
    const profileSection = document.getElementById('profileSection');
    const navHome = document.getElementById('navHome');
    const navProfile = document.getElementById('navProfile');
    const backToHome = document.getElementById('backToHome');
    const profilePhotoInput = document.getElementById('profilePhotoInput');
    const profileImage = document.getElementById('profileImage');
    const saveProfile = document.getElementById('saveProfile');
    
    // Elementos del reproductor personalizado
    const landscapePlayer = document.getElementById('landscapePlayer');
    const landscapeVideo = document.getElementById('landscapeVideo');
    const subtitleContainer = document.getElementById('subtitleContainer');
    const subtitleText = document.getElementById('subtitleText');
    const subtitleSettings = document.getElementById('subtitleSettings');
    const transcriptionIndicator = document.getElementById('transcriptionIndicator');
    const sourceLanguage = document.getElementById('sourceLanguage');
    const targetLanguage = document.getElementById('targetLanguage');
    const toggleSubtitles = document.getElementById('toggleSubtitles');
    const toggleTranslation = document.getElementById('toggleTranslation');
    const closeSettings = document.getElementById('closeSettings');
    const landscapePlayPause = document.getElementById('landscapePlayPause');
    const landscapeRewind = document.getElementById('landscapeRewind');
    const landscapeForward = document.getElementById('landscapeForward');
    const landscapeSubtitles = document.getElementById('landscapeSubtitles');
    const landscapeVolume = document.getElementById('landscapeVolume');
    const landscapeClose = document.getElementById('landscapeClose');
    const landscapeProgressFill = document.getElementById('landscapeProgressFill');

    /***************** Funci贸n de B煤squeda en Tiempo Real ******************/
    searchBtn.addEventListener('click', () => {
      const query = searchInput.value.trim();
      if (query !== "") {
        searchSpinner.classList.remove('hidden');
        // Simulaci贸n de b煤squeda (en una app real se conectar铆a con una API)
        setTimeout(() => {
          searchSpinner.classList.add('hidden');
          alert("Resultados de b煤squeda para: " + query);
        }, 1500);
      }
    });

    searchInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        searchBtn.click();
      }
    });

    /***************** Manejador de Archivos (Videos) ******************/
    fileInput.addEventListener('change', handleFileUpload);
    function handleFileUpload(event) {
      const files = Array.from(event.target.files).filter(file => file.type.startsWith('video/'));
      videos = files.map(file => ({
        id: Math.random().toString(36).substr(2, 9),
        url: URL.createObjectURL(file),
        name: file.name
      }));
      if (videos.length > 0) {
        updateVideoDisplay();
        updateIndicators();
      }
    }

    function updateVideoDisplay() {
      if (videos.length === 0) return;
      videoWrapper.innerHTML = `
        <video
          src="${videos[currentIndex].url}"
          autoplay
          loop
          playsinline
          webkit-playsinline
          x5-playsinline
          muted
          preload="metadata"
          style="width: 100%; height: 100%; object-fit: cover; pointer-events: none;"
        ></video>
      `;
      const video = videoWrapper.querySelector('video');
      
      // Configuraci贸n espec铆fica para iOS y prevenci贸n de controles nativos
      video.controls = false;
      video.setAttribute('controls', 'false');
      video.setAttribute('playsinline', 'true');
      video.setAttribute('webkit-playsinline', 'true');
      video.setAttribute('x5-playsinline', 'true');
      video.muted = true;
      video.defaultMuted = true;
      
      // Prevenir eventos nativos del video en iOS
      video.addEventListener('webkitbeginfullscreen', (e) => {
        e.preventDefault();
        e.stopPropagation();
        return false;
      });
      
      video.addEventListener('webkitendfullscreen', (e) => {
        e.preventDefault();
        e.stopPropagation();
        return false;
      });
      
      // Prevenir el reproductor nativo de iOS
      video.addEventListener('loadstart', () => {
        video.controls = false;
        video.removeAttribute('controls');
      });
      
      video.addEventListener('loadedmetadata', () => {
        video.controls = false;
        video.removeAttribute('controls');
      });
      
      // Configurar volumen inicial
      video.volume = 1.0;
      
      startProgressBar(video);
      likeBtn.classList.toggle('active', !!likes[videos[currentIndex].id]);
      
      // Manejar reproducci贸n con primer toque (necesario para iOS)
      let hasInteracted = false;
      const handleFirstInteraction = () => {
        if (!hasInteracted) {
          hasInteracted = true;
          video.muted = false; // Permitir audio despu茅s del primer toque
          video.play().catch(e => console.log('Autoplay prevented:', e));
        }
      };
      
      // Click en el contenedor, no en el video
      const clickHandler = () => {
        handleFirstInteraction();
        if (video.paused) {
          video.play();
          document.querySelector('.pause-indicator').classList.remove('visible');
        } else {
          video.pause();
          document.querySelector('.pause-indicator').classList.add('visible');
        }
      };
      
      videoWrapper.removeEventListener('click', clickHandler);
      videoWrapper.addEventListener('click', clickHandler);
      
      // Prevenir contexto de men煤 en el video
      video.addEventListener('contextmenu', (e) => {
        e.preventDefault();
        return false;
      });
      
      // Prevenir selecci贸n del video
      video.addEventListener('selectstart', (e) => {
        e.preventDefault();
        return false;
      });
    }

    function startProgressBar(video) {
      const progressBar = document.querySelector('.progress-bar');
      clearInterval(progressInterval);
      progressInterval = setInterval(() => {
        const progress = (video.currentTime / video.duration) * 100;
        progressBar.style.width = `${progress}%`;
      }, 100);
    }

    function updateIndicators() {
      indicators.innerHTML = videos.map((_, idx) => `
        <div class="indicator ${idx === currentIndex ? 'active' : ''}"></div>
      `).join('');
    }

    /***************** Funciones de Like y Favoritos ******************/
    function toggleLike(videoId) {
      likes[videoId] = !likes[videoId];
      likeBtn.classList.toggle('active', likes[videoId]);
    }
    likeBtn.addEventListener('click', () => {
      if (videos.length > 0) {
        toggleLike(videos[currentIndex].id);
      }
    });
    favBtn.addEventListener('click', () => {
      if (videos.length > 0) {
        const videoId = videos[currentIndex].id;
        favorites[videoId] = !favorites[videoId];
        favBtn.classList.toggle('active', favorites[videoId]);
      }
    });

    /***************** Eventos T谩ctiles (deslizamientos) ******************/
    document.addEventListener('touchstart', handleTouchStart, false);
    document.addEventListener('touchmove', handleTouchMove, false);
    document.addEventListener('touchend', handleTouchEnd, false);
    function handleTouchStart(evt) {
      touchStartY = evt.touches[0].clientY;
      touchStartX = evt.touches[0].clientX;
      touchStartTime = Date.now();
      lastTapTime = Date.now();
    }
    function handleTouchMove(evt) {
      if (!touchStartX) return;
      const touchX = evt.touches[0].clientX;
      const diffX = touchStartX - touchX;
      if (Math.abs(diffX) > 30) {
        document.querySelector('.video-controls').classList.toggle('hidden', diffX < 0);
      }
    }
    function handleTouchEnd(evt) {
      if (videos.length === 0) return;
      const touchEndY = evt.changedTouches[0].clientY;
      const diffY = touchStartY - touchEndY;
      const timeDiff = Date.now() - touchStartTime;
      if (Math.abs(diffY) > 50 && timeDiff < 300) {
        if (diffY > 0 && currentIndex < videos.length - 1) {
          currentIndex++;
        } else if (diffY < 0 && currentIndex > 0) {
          currentIndex--;
        }
        updateVideoDisplay();
        updateIndicators();
      }
      touchStartX = null;
    }

    /***************** Navegaci贸n entre secciones ******************/
    navHome.addEventListener('click', () => {
      homeSection.classList.remove('hidden');
      profileSection.classList.add('hidden');
      navHome.classList.add('active');
      navProfile.classList.remove('active');
    });
    navProfile.addEventListener('click', () => {
      profileSection.classList.remove('hidden');
      homeSection.classList.add('hidden');
      navProfile.classList.add('active');
      navHome.classList.remove('active');
    });
    backToHome.addEventListener('click', () => {
      profileSection.classList.add('hidden');
      homeSection.classList.remove('hidden');
      navHome.classList.add('active');
      navProfile.classList.remove('active');
    });

    /***************** Perfil: Subir foto y guardar nombre de usuario ******************/
    profilePhotoInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(evt) {
          profileImage.src = evt.target.result;
        }
        reader.readAsDataURL(file);
      }
    });
    saveProfile.addEventListener('click', () => {
      const username = document.getElementById('usernameInput').value;
      alert("Perfil guardado: " + username);
    });

    /***************** Detector de Orientaci贸n ******************/
    function handleOrientationChange() {
      const orientation = window.screen.orientation || window.orientation;
      const isLandscapeNow = window.innerWidth > window.innerHeight;
      
      if (isLandscapeNow && !isLandscape && videos.length > 0) {
        isLandscape = true;
        showLandscapePlayer();
      } else if (!isLandscapeNow && isLandscape) {
        isLandscape = false;
        hideLandscapePlayer();
      }
    }

    window.addEventListener('orientationchange', handleOrientationChange);
    window.addEventListener('resize', handleOrientationChange);

    /***************** Reproductor Personalizado ******************/
    function showLandscapePlayer() {
      if (videos.length === 0) return;
      
      const currentVideo = videoWrapper.querySelector('video');
      if (currentVideo) {
        landscapeVideo.src = currentVideo.src;
        landscapeVideo.currentTime = currentVideo.currentTime;
        
        // Configuraci贸n espec铆fica para iOS en reproductor paisaje
        landscapeVideo.controls = false;
        landscapeVideo.setAttribute('controls', 'false');
        landscapeVideo.setAttribute('playsinline', 'true');
        landscapeVideo.setAttribute('webkit-playsinline', 'true');
        landscapeVideo.setAttribute('x5-playsinline', 'true');
        landscapeVideo.muted = false; // En paisaje permitimos audio
        landscapeVideo.volume = 1.0;
        
        // Prevenir pantalla completa autom谩tica en iOS
        landscapeVideo.addEventListener('webkitbeginfullscreen', (e) => {
          e.preventDefault();
          e.stopPropagation();
          return false;
        });
        
        landscapeVideo.addEventListener('webkitendfullscreen', (e) => {
          e.preventDefault();
          e.stopPropagation();
          return false;
        });
        
        // Prevenir controles nativos durante la carga
        landscapeVideo.addEventListener('loadstart', () => {
          landscapeVideo.controls = false;
          landscapeVideo.removeAttribute('controls');
        });
        
        landscapeVideo.addEventListener('loadedmetadata', () => {
          landscapeVideo.controls = false;
          landscapeVideo.removeAttribute('controls');
        });
        
        landscapePlayer.classList.add('active');
        landscapeVideo.play().catch(e => console.log('Play prevented:', e));
        startLandscapeProgress();
        
        // Esperar a que el video est茅 listo antes de iniciar transcripci贸n
        landscapeVideo.addEventListener('loadeddata', () => {
          if (subtitlesEnabled) {
            initVideoAudioTranscription();
          }
        });
        
        // Prevenir contexto de men煤
        landscapeVideo.addEventListener('contextmenu', (e) => {
          e.preventDefault();
          return false;
        });
      }
    }

    function hideLandscapePlayer() {
      landscapePlayer.classList.remove('active');
      const currentVideo = videoWrapper.querySelector('video');
      if (currentVideo && landscapeVideo.src) {
        currentVideo.currentTime = landscapeVideo.currentTime;
        if (!landscapeVideo.paused) {
          currentVideo.play();
        }
      }
      stopSpeechRecognition();
      clearInterval(landscapeProgressInterval);
    }

    function startLandscapeProgress() {
      clearInterval(landscapeProgressInterval);
      landscapeProgressInterval = setInterval(() => {
        if (landscapeVideo.duration) {
          const progress = (landscapeVideo.currentTime / landscapeVideo.duration) * 100;
          landscapeProgressFill.style.width = `${progress}%`;
        }
      }, 100);
    }

    /***************** Transcripci贸n de Audio del Video ******************/
    let audioContext;
    let mediaStreamSource;
    let processor;
    let mediaStream;
    let isTranscribing = false;

    async function initVideoAudioTranscription() {
      try {
        if (isTranscribing) {
          console.log('Ya hay una transcripci贸n activa');
          return;
        }

        // Crear contexto de audio
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // M茅todo 1: Intentar capturar stream directamente del video
        const video = landscapeVideo;
        
        try {
          // Para navegadores que soportan captureStream
          if (video.captureStream) {
            mediaStream = video.captureStream();
          } else if (video.mozCaptureStream) {
            mediaStream = video.mozCaptureStream();
          } else {
            throw new Error('captureStream no soportado');
          }

          const audioTracks = mediaStream.getAudioTracks();
          if (audioTracks.length === 0) {
            throw new Error('No hay pistas de audio en el video');
          }

          console.log('Usando audio del video directamente');
          
          // Crear fuente de audio desde el stream del video
          mediaStreamSource = audioContext.createMediaStreamSource(mediaStream);
          
          // Configurar Web Speech API con audio del video
          setupSpeechRecognitionWithVideoAudio();
          
        } catch (videoError) {
          console.log('No se puede capturar audio del video:', videoError.message);
          console.log('Intentando m茅todo alternativo...');
          
          // M茅todo 2: Usar Web Audio API para procesar el audio del video
          try {
            const audioSource = audioContext.createMediaElementSource(video);
            const destination = audioContext.createMediaStreamDestination();
            audioSource.connect(destination);
            audioSource.connect(audioContext.destination); // Mantener audio audible
            
            mediaStream = destination.stream;
            setupSpeechRecognitionWithVideoAudio();
            
          } catch (webAudioError) {
            console.log('Web Audio API fall贸:', webAudioError.message);
            console.log('Usando transcripci贸n simulada basada en tiempo del video');
            
            // M茅todo 3: Fallback - simulaci贸n de transcripci贸n
            simulateVideoTranscription();
          }
        }

      } catch (error) {
        console.error('Error al inicializar transcripci贸n de video:', error);
        simulateVideoTranscription();
      }
    }

    function setupSpeechRecognitionWithVideoAudio() {
      if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
        console.log('Speech Recognition no soportado, usando transcripci贸n simulada');
        simulateVideoTranscription();
        return;
      }

      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SpeechRecognition();
      
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.lang = sourceLanguage.value;
      isTranscribing = true;

      recognition.onstart = () => {
        transcriptionIndicator.classList.add('active');
        updateSubtitleStatus('Transcribiendo audio del video...', true);
      };

      recognition.onresult = (event) => {
        let finalTranscript = '';
        let interimTranscript = '';

        for (let i = event.resultIndex; i < event.results.length; i++) {
          const transcript = event.results[i][0].transcript;
          if (event.results[i].isFinal) {
            finalTranscript += transcript;
          } else {
            interimTranscript += transcript;
          }
        }

        const fullTranscript = finalTranscript || interimTranscript;
        if (fullTranscript && subtitlesEnabled) {
          console.log('Transcripci贸n detectada:', fullTranscript);
          if (translationEnabled) {
            translateText(fullTranscript);
          } else {
            displaySubtitle(fullTranscript);
          }
        }
      };

      recognition.onerror = (event) => {
        console.error('Error en reconocimiento de voz:', event.error);
        updateSubtitleStatus('Error en transcripci贸n', false);
        
        if (event.error === 'not-allowed') {
          alert('Permite el acceso al micr贸fono para transcribir el audio del video');
        }
        
        setTimeout(() => {
          if (subtitlesEnabled && !landscapeVideo.paused) {
            recognition.start();
          }
        }, 2000);
      };

      recognition.onend = () => {
        isTranscribing = false;
        if (subtitlesEnabled && !landscapeVideo.paused) {
          setTimeout(() => {
            if (!isTranscribing) {
              recognition.start();
            }
          }, 100);
        } else {
          transcriptionIndicator.classList.remove('active');
          updateSubtitleStatus('Transcripci贸n detenida', false);
        }
      };

      recognition.start();
    }

    // Funci贸n de transcripci贸n simulada para cuando no se puede acceder al audio del video
    function simulateVideoTranscription() {
      if (!subtitlesEnabled) return;
      
      console.log('Iniciando transcripci贸n simulada del video');
      transcriptionIndicator.classList.add('active');
      updateSubtitleStatus('Transcripci贸n simulada activa', true);
      
      // Generar subt铆tulos de ejemplo basados en el tiempo del video
      const simulatedSubtitles = [
        "Este es un ejemplo de subt铆tulos generados autom谩ticamente",
        "La transcripci贸n real requiere permisos de micr贸fono",
        "Los subt铆tulos aparecen sincronizados con el video",
        "Puedes activar la traducci贸n en tiempo real",
        "Esta funcionalidad funciona mejor con audio claro"
      ];
      
      let subtitleIndex = 0;
      const subtitleInterval = setInterval(() => {
        if (!subtitlesEnabled || landscapeVideo.paused) {
          clearInterval(subtitleInterval);
          transcriptionIndicator.classList.remove('active');
          return;
        }
        
        const currentSubtitle = simulatedSubtitles[subtitleIndex % simulatedSubtitles.length];
        
        if (translationEnabled) {
          translateText(currentSubtitle);
        } else {
          displaySubtitle(currentSubtitle);
        }
        
        subtitleIndex++;
      }, 3000); // Cambiar subt铆tulo cada 3 segundos
    }

    function updateSubtitleStatus(message, isActive) {
      const statusElement = document.getElementById('subtitleStatus');
      const statusText = statusElement.querySelector('span');
      statusText.textContent = `Estado: ${message}`;
      
      if (isActive) {
        statusElement.classList.add('active');
      } else {
        statusElement.classList.remove('active');
      }
    }

    function initSpeechRecognition() {
      if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
        console.log('Speech recognition not supported');
        return;
      }

      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SpeechRecognition();
      
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.lang = sourceLanguage.value;

      recognition.onstart = () => {
        transcriptionIndicator.classList.add('active');
      };

      recognition.onresult = (event) => {
        let finalTranscript = '';
        let interimTranscript = '';

        for (let i = event.resultIndex; i < event.results.length; i++) {
          const transcript = event.results[i][0].transcript;
          if (event.results[i].isFinal) {
            finalTranscript += transcript;
          } else {
            interimTranscript += transcript;
          }
        }

        const fullTranscript = finalTranscript || interimTranscript;
        if (fullTranscript && subtitlesEnabled) {
          if (translationEnabled) {
            translateText(fullTranscript);
          } else {
            displaySubtitle(fullTranscript);
          }
        }
      };

      recognition.onerror = (event) => {
        console.error('Speech recognition error:', event.error);
      };

      recognition.onend = () => {
        if (subtitlesEnabled && !landscapeVideo.paused) {
          recognition.start();
        } else {
          transcriptionIndicator.classList.remove('active');
        }
      };

      recognition.start();
    }

    function stopSpeechRecognition() {
      if (recognition) {
        recognition.stop();
        transcriptionIndicator.classList.remove('active');
      }
    }

    /***************** Traducci贸n con Google Translate API ******************/
    async function translateText(text) {
      if (!translationEnabled) {
        displaySubtitle(text);
        return;
      }

      try {
        // Usando la API gratuita de Google Translate
        const response = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${getLanguageCode(sourceLanguage.value)}&tl=${targetLanguage.value}&dt=t&q=${encodeURIComponent(text)}`);
        const data = await response.json();
        
        if (data && data[0] && data[0][0]) {
          const translatedText = data[0][0][0];
          displaySubtitle(translatedText);
        } else {
          displaySubtitle(text);
        }
      } catch (error) {
        console.error('Translation error:', error);
        displaySubtitle(text);
      }
    }

    function getLanguageCode(fullCode) {
      return fullCode.split('-')[0];
    }

    function displaySubtitle(text) {
      subtitleText.textContent = text;
      subtitleContainer.style.display = 'block';
      
      // Ocultar despu茅s de 3 segundos si no hay nuevo texto
      clearTimeout(subtitleContainer.hideTimeout);
      subtitleContainer.hideTimeout = setTimeout(() => {
        subtitleContainer.style.display = 'none';
      }, 3000);
    }

    /***************** Event Listeners del Reproductor Personalizado ******************/
    landscapePlayPause.addEventListener('click', () => {
      if (landscapeVideo.paused) {
        landscapeVideo.play();
        landscapePlayPause.innerHTML = '<i class="fas fa-pause"></i>';
        if (subtitlesEnabled) {
          recognition.start();
        }
      } else {
        landscapeVideo.pause();
        landscapePlayPause.innerHTML = '<i class="fas fa-play"></i>';
        if (recognition) {
          recognition.stop();
        }
      }
    });

    landscapeRewind.addEventListener('click', () => {
      landscapeVideo.currentTime = Math.max(0, landscapeVideo.currentTime - 10);
    });

    landscapeForward.addEventListener('click', () => {
      landscapeVideo.currentTime = Math.min(landscapeVideo.duration, landscapeVideo.currentTime + 10);
    });

    landscapeVolume.addEventListener('click', () => {
      if (landscapeVideo.muted || landscapeVideo.volume === 0) {
        landscapeVideo.muted = false;
        landscapeVideo.volume = 1.0;
        landscapeVolume.innerHTML = '<i class="fas fa-volume-up"></i>';
      } else {
        landscapeVideo.muted = true;
        landscapeVolume.innerHTML = '<i class="fas fa-volume-mute"></i>';
      }
    });

    landscapeSubtitles.addEventListener('click', () => {
      subtitleSettings.classList.toggle('visible');
    });

    landscapeClose.addEventListener('click', () => {
      hideLandscapePlayer();
      // Forzar orientaci贸n vertical
      if (screen.orientation && screen.orientation.lock) {
        screen.orientation.lock('portrait');
      }
    });

    toggleSubtitles.addEventListener('click', () => {
      subtitlesEnabled = !subtitlesEnabled;
      const icon = subtitlesEnabled ? 'fas fa-closed-captioning' : 'far fa-closed-captioning';
      const text = subtitlesEnabled ? 'Desactivar Subt铆tulos' : 'Activar Subt铆tulos';
      toggleSubtitles.innerHTML = `<i class="${icon}"></i> ${text}`;
      
      if (subtitlesEnabled && !landscapeVideo.paused) {
        updateSubtitleStatus('Iniciando transcripci贸n...', true);
        initVideoAudioTranscription();
      } else {
        stopSpeechRecognition();
        subtitleContainer.style.display = 'none';
        updateSubtitleStatus('Inactivo', false);
      }
    });

    toggleTranslation.addEventListener('click', () => {
      translationEnabled = !translationEnabled;
      const icon = translationEnabled ? 'fas fa-language' : 'far fa-comments';
      const text = translationEnabled ? 'Desactivar Traducci贸n' : 'Activar Traducci贸n';
      toggleTranslation.innerHTML = `<i class="${icon}"></i> ${text}`;
      
      if (translationEnabled) {
        updateSubtitleStatus('Traducci贸n activada', true);
      } else {
        updateSubtitleStatus(subtitlesEnabled ? 'Solo subt铆tulos' : 'Inactivo', subtitlesEnabled);
      }
    });

    closeSettings.addEventListener('click', () => {
      subtitleSettings.classList.remove('visible');
    });

    sourceLanguage.addEventListener('change', () => {
      if (recognition) {
        recognition.lang = sourceLanguage.value;
      }
    });

    landscapeVideo.addEventListener('play', () => {
      landscapePlayPause.innerHTML = '<i class="fas fa-pause"></i>';
    });

    landscapeVideo.addEventListener('pause', () => {
      landscapePlayPause.innerHTML = '<i class="fas fa-play"></i>';
    });

    /***************** Service Worker para modo offline ******************/
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').then(
        function(registration) {
          console.log('ServiceWorker registration successful');
        },
        function(err) {
          console.log('ServiceWorker registration failed: ', err);
        }
      );
    }
  </script>
</body>
</html>
